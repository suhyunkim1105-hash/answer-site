<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>고려대 논술 AI 테스트</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      max-width: 900px;
      margin: 16px auto;
      padding: 0 12px;
      line-height: 1.5;
    }
    h1 {
      font-size: 20px;
      margin-bottom: 12px;
    }
    textarea {
      width: 100%;
      min-height: 220px;
      box-sizing: border-box;
      padding: 8px;
      font-family: inherit;
      font-size: 14px;
      white-space: pre-wrap;
    }
    button {
      margin-top: 8px;
      padding: 8px 14px;
      font-size: 14px;
      cursor: pointer;
    }
    #status {
      margin-top: 8px;
      font-size: 13px;
      opacity: 0.8;
    }
    pre {
      margin-top: 12px;
      padding: 10px;
      background: #111;
      color: #eee;
      white-space: pre-wrap;
      word-break: break-word;
      font-size: 13px;
    }
  </style>
</head>
<body>
  <h1>고려대 인문계 일반편입 논술 AI 테스트</h1>

  <p style="font-size:13px;">
    아래 칸에 제시문 ①, ②, ③, ④와 [문제 1], [문제 2]까지
    <b>그냥 통째로 복붙</b>한 다음, 버튼을 누르면 상위 1% 스타일 답안을 받는다.
  </p>

  <textarea id="input" placeholder="여기에 고려대 논술 제시문 + [문제 1] [문제 2] 전체를 붙여넣으세요."></textarea>

  <div>
    <button id="runBtn">AI 답안 생성하기</button>
  </div>

  <div id="status"></div>

  <pre id="output"></pre>

  <script>
    async function runEssay() {
      const text = document.getElementById("input").value.trim();
      const statusEl = document.getElementById("status");
      const outEl = document.getElementById("output");

      if (!text) {
        alert("먼저 제시문 + 문제 전체를 붙여넣어야 해.");
        return;
      }

      statusEl.textContent = "AI에 보내는 중...";
      outEl.textContent = "";

      try {
        const res = await fetch("/.netlify/functions/solve", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            // solve.js가 어떤 이름을 쓰든 잡히게 안전하게 여러 키에 다 넣어 준다.
            mode: "ESSAY",
            text,
            question: text,
            prompt: text
          })
        });

        const bodyText = await res.text();

        if (!res.ok) {
          statusEl.textContent = "에러 발생 (HTTP " + res.status + ")";
          outEl.textContent = bodyText || "서버에서 에러가 났어.";
          return;
        }

        statusEl.textContent = "완료. 아래에 답안이 나왔어.";
        outEl.textContent = bodyText;
      } catch (err) {
        statusEl.textContent = "요청 실패";
        outEl.textContent = String(err);
      }
    }

    document.addEventListener("DOMContentLoaded", () => {
      document.getElementById("runBtn").addEventListener("click", runEssay);
    });
  </script>
</body>
</html>
