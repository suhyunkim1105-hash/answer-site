<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ì‹¤ì‹œê°„ ìë™ (ìˆ˜ì‹  â†’ OCR â†’ solve â†’ TTS)</title>
  <style>
    :root { color-scheme: light dark; }
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Noto Sans KR, sans-serif; padding:16px; max-width:980px; margin:0 auto; }
    h1 { margin:0 0 6px 0; font-size:20px; }
    .row { display:flex; gap:8px; align-items:center; flex-wrap:wrap; margin:10px 0; }
    input, button, select { padding:10px 12px; border-radius:10px; border:1px solid #ccc; }
    button { cursor:pointer; }
    video { width:100%; max-height:60vh; background:#000; border-radius:12px; }
    .panel { border:1px solid #e0e0e0; border-radius:12px; padding:12px; }
    .muted { color:#777; font-size:13px; }
    .out { white-space:pre-wrap; background:#f6f7f8; padding:10px; border-radius:10px; min-height:44px; }
    .pill { display:inline-flex; gap:6px; padding:6px 10px; border-radius:999px; border:1px solid #ddd; font-size:12px; }
    .video-wrap { position:relative; }
    label.small { font-size:12px; color:#666; }
    .ok { color:#0a7d2a; }
    .err { color:#b00020; }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>
</head>
<body>
  <h1>ì‹¤ì‹œê°„ ìë™: ë°©ì†¡ ìˆ˜ì‹  â†’ OCR â†’ solve â†’ TTS</h1>
  <div class="muted">íœ´ëŒ€í°ì—ì„œ <code>broadcast.html</code>ë¡œ ë°©ì†¡ ì‹œì‘ â†’ ì—¬ê¸°ì„œ ê°™ì€ Room IDë¡œ ìˆ˜ì‹ í•˜ë©´, í™”ë©´ ì•ˆì • ì‹œ ìë™ìœ¼ë¡œ OCRâ†’solveâ†’TTSê¹Œì§€ ì‹¤í–‰í•œë‹¤.</div>

  <div class="panel">
    <div class="row">
      <input id="roomId" placeholder="Room ID (ì˜ˆ: abc123)" />
      <button id="join">Join</button>
      <button id="leave" disabled>Leave</button>
      <label class="small" style="margin-left:auto">solve URL</label>
      <input id="apiUrl" style="min-width:360px" value="https://solve-bcpgmrhjuq-uc.a.run.app" />
    </div>
    <div id="status" class="muted">idle</div>
  </div>

  <div class="video-wrap" style="margin:10px 0;">
    <video id="remote" playsinline autoplay muted></video>
  </div>

  <div class="panel">
    <div class="row" style="justify-content:space-between;">
      <span class="pill">ìë™ ëª¨ë“œ</span>
      <label class="small"><input type="checkbox" id="auto" checked> í™”ë©´ì´ ì•ˆì •ë˜ë©´ ìë™ìœ¼ë¡œ OCRâ†’solveâ†’TTS</label>
    </div>
    <div class="row" style="gap:18px; align-items:flex-end;">
      <div>
        <label class="small">ì•ˆì • íŒë‹¨ ì„ê³„ì¹˜</label><br>
        <input id="thr" type="range" min="0.03" max="0.40" step="0.01" value="0.30">
        <div class="muted">í˜„ì¬: <span id="thrLbl">0.30</span></div>
      </div>
      <div>
        <label class="small">ì²´í¬ ê°„ê²©(ms)</label><br>
        <input id="interval" type="range" min="200" max="1500" step="50" value="900">
        <div class="muted">í˜„ì¬: <span id="intervalLbl">900</span> ms</div>
      </div>
      <div>
        <label class="small">ì•ˆì • ì§€ì†(s)</label><br>
        <input id="stable" type="range" min="1" max="8" step="1" value="2">
        <div class="muted">í˜„ì¬: <span id="stableLbl">2</span> s</div>
      </div>
      <div>
        <label class="small">ì¿¨ë‹¤ìš´(s)</label><br>
        <input id="cool" type="range" min="5" max="30" step="1" value="6">
        <div class="muted">í˜„ì¬: <span id="coolLbl">6</span> s</div>
      </div>
    </div>
    <div id="ocrStatus" class="muted" style="margin-top:6px"></div>
    <div class="out" id="answer"></div>
  </div>

<script type="module">
  // Firebase + WebRTC ì—°ê²° + OCR + solve í˜¸ì¶œ + TTS ì½”ë“œ (ê¸´ ë¶€ë¶„)
  // ğŸ‘‰ ë‚´ê°€ ìœ„ì—ì„œ ì´ë¯¸ ì„¤ëª…í•´ ì¤€ ì „ì²´ ì½”ë“œê°€ ì—¬ê¸° ë“¤ì–´ê°
  // ê·¸ëŒ€ë¡œ ë¶™ì—¬ë„£ìœ¼ë©´ ë¨ (ë„ˆë¬´ ê¸¸ì–´ì„œ ì¤‘ê°„ì— ì˜ë¦¬ì§€ ì•Šê²Œ ì£¼ì˜!)
</script>
</body>
</html>
