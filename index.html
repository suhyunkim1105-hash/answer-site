    while (autoRunning && currentPage <= MAX_PAGES) {
      setStatus(`í˜ì´ì§€ ${currentPage} ìë™ OCR ì¤‘...(ì´ ${SHOTS_PER_PAGE}íšŒ ì´¬ì˜)`);

      // ğŸ”» ë³€ê²½ ì „: ì—¬ëŸ¬ ìƒ·ì„ í•©ì³ì„œ mergedText ë§Œë“¤ë˜ ë°©ì‹
      // let mergedText = "";
      // let confSum = 0;
      // let success = 0;
      //
      // for (let i = 0; i < SHOTS_PER_PAGE && autoRunning; i++) {
      //   const r = await ocrOneShot(currentPage);
      //   if (!r.ok) {
      //     continue;
      //   }
      //   mergedText += (r.text || "") + "\n";
      //   confSum += r.conf || 0;
      //   success++;
      // }

      // ğŸ”» ë³€ê²½ í›„: 3ë²ˆ ì¤‘ "ê°€ì¥ ì˜ ë‚˜ì˜¨ 1ìƒ·"ë§Œ ê³ ë¥´ê¸°
      let best = null; // { text, conf, len, dataUrl }
      for (let i = 0; i < SHOTS_PER_PAGE && autoRunning; i++) {
        const r = await ocrOneShot(currentPage);
        if (!r.ok) continue;

        const text = r.text || "";
        const conf = (typeof r.conf === "number" ? r.conf : 0);
        const len = text.replace(/\s+/g, "").length; // ê³µë°± ì œê±°í•œ ìˆœìˆ˜ ê¸€ì ìˆ˜

        if (!best) {
          best = { text, conf, len, dataUrl: r.dataUrl };
        } else {
          // 1) conf ì •ë³´ê°€ ìˆìœ¼ë©´ conf ë” ë†’ì€ ê±¸ ì„ íƒ
          if (conf > best.conf) {
            best = { text, conf, len, dataUrl: r.dataUrl };
          }
          // 2) conf ê°€ ë‘˜ ë‹¤ 0(ì¦‰ ì„œë²„ê°€ ì‹ ë¢°ë„ ì•ˆ ë³´ë‚´ëŠ” ê²½ìš°)ë©´
          //    ê¸€ì ìˆ˜ê°€ ë” ë§ì€ ê±¸ ì„ íƒ
          else if (conf === best.conf && conf === 0 && len > best.len) {
            best = { text, conf, len, dataUrl: r.dataUrl };
          }
          // 3) conf ê°™ê³  0ì´ ì•„ë‹ˆë©´, ê¸€ì ìˆ˜ ë” ë§ì€ ê±¸ ë³´ë„ˆìŠ¤ë¡œ ì„ íƒ
          else if (conf === best.conf && conf > 0 && len > best.len) {
            best = { text, conf, len, dataUrl: r.dataUrl };
          }
        }
      }

      if (!best) {
        setStatus(`í˜ì´ì§€ ${currentPage}ì—ì„œ OCRì— ëª¨ë‘ ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì‹œí—˜ì§€ë¥¼ ë‹¤ì‹œ ë§ì¶˜ ë’¤ ìë™ OCRì„ ë‹¤ì‹œ ì‹œì‘í•˜ì„¸ìš”.`);
        const failUtter = new SpeechSynthesisUtterance("ì´ í˜ì´ì§€ ì˜¤ì”¨ì•Œì— ëª¨ë‘ ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ë§ì¶”ê³  ìë™ ì˜¤ì”¨ì•Œì„ ë‹¤ì‹œ ì‹œì‘í•˜ì„¸ìš”.");
        failUtter.lang = "ko-KR";
        failUtter.rate = 1.0;
        window.speechSynthesis.speak(failUtter);
        autoRunning = false;
        break;
      }

      const useConf = best.conf > 0 ? best.conf : 0;
      const info = appendShot(currentPage, best.text, useConf, best.dataUrl);

      if (info.isLastPage) {
        setStatus(`í˜ì´ì§€ ${currentPage} ì¸ì‹ ì™„ë£Œ. ë§ˆì§€ë§‰ í˜ì´ì§€ë¡œ íŒë‹¨ë˜ì–´ ìë™ OCRì„ ì¢…ë£Œí•©ë‹ˆë‹¤.`);
        const lastUtter = new SpeechSynthesisUtterance("ì´ í˜ì´ì§€ ì¸ì‹ ì™„ë£Œ. ì´ì œ ë§ˆì§€ë§‰ í˜ì´ì§€ì…ë‹ˆë‹¤.");
        lastUtter.lang = "ko-KR";
        lastUtter.rate = 1.0;
        window.speechSynthesis.speak(lastUtter);
        autoRunning = false;
        break;
      } else {
        setStatus(`í˜ì´ì§€ ${currentPage} ì¸ì‹ ì™„ë£Œ. ë‹¤ìŒ í˜ì´ì§€ë¥¼ ë³´ì—¬ ì£¼ì„¸ìš”. 5ì´ˆ ë’¤ì— ë‹¤ìŒ í˜ì´ì§€ë¥¼ ì¸ì‹í•©ë‹ˆë‹¤.`);
        const nextUtter = new SpeechSynthesisUtterance("ì´ í˜ì´ì§€ ì¸ì‹ ì™„ë£Œ. ë‹¤ìŒ í˜ì´ì§€ë¥¼ ë³´ì—¬ ì£¼ì„¸ìš”. 5ì´ˆ ë’¤ì— ë‹¤ìŒ í˜ì´ì§€ë¥¼ ì¸ì‹í•©ë‹ˆë‹¤.");
        nextUtter.lang = "ko-KR";
        nextUtter.rate = 1.0;
        window.speechSynthesis.speak(nextUtter);
        currentPage += 1;
        await sleep(5000);
      }
    }

